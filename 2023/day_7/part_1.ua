Input ← &fras "input.txt"

CToValue ← ⊙;∵((((((1|10)=@T.|11)=@J.|12)=@Q.|13)=@K.|14)=@A.)

⊜□≠@\n. Input
∵(⊜□≠@ .°□)
⍜⍉(⊟⊃(≡□⊐∵(×⊃(CToValue)(+1×⊙(-1-@0)¬×≥@A,≤@Z.))⊢)(⊐⋕⊢↘1))
≡(□⊕□⊛.°□⊢).
⊐≡(-⊃(⧻)(⊢⊏⍖.⊐∵⧻))
⊕□⊛⊃(⊏⊙∘)(⊏⊙⋅∘)⍖.
≡(⍜°□(⊏⊙°□⍖⊐≡(⊢)).)
⊐/⊂
⇌♭≡(°□⊢↘1)
/+×+1⇡⧻.
